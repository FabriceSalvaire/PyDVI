#####################################################################################################
#
# PyDVI - Python Library to Process DVI Stream
# Copyright (C) 2009 Salvaire Fabrice
#
#####################################################################################################

#####################################################################################################
#
# Audit
#
#  - 10/01/2010 fabrice
#
#####################################################################################################

#####################################################################################################

__ALL__ = ['kpsewhich']

#####################################################################################################

import subprocess

#####################################################################################################

def kpsewhich(filename, file_format = None):

    '''
    Wrapper around kpsewhich program
    '''

    command = ['kpsewhich']

    if file_format is not None:
        command.append("--format='%s'" % (file_format))

    command.append(filename)

    command_string = ' '.join(command)

    pipe = subprocess.Popen(command_string, shell=True, stdout=subprocess.PIPE)
        
    stdout = pipe.communicate()[0]

    path = stdout.rstrip()

    if path:
        return path
    else:
        return None

#####################################################################################################
#
# End
#
#####################################################################################################
